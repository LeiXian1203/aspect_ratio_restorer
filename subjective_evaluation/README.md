アスペクト比修正の主観評価実験用ツール
=====
人間のアスペクト比修正能力を調査するために、被験者にアスペクト比修正課題を与え、その成績を集計する必要があります。ここでは、その課題に用いるpptxファイルを自動生成するスクリプトと、被験者らの回答の成績を自動集計するスクリプトについて説明します。

## 依存パッケージのインストール
以下のコマンドで `python-pptx` をインストールしてください。

```
pip install python-pptx
```

## 課題用pptxファイルの生成
1. `images` ディレクトリの中に課題用の元画像ファイル（つまり無劣化ファイル）を配置します。
2. `labels.txt` ファイルに、課題画像を生成するための情報として、元画像とその画像の伸長値のペア達を列挙します。フォーマットは、一行ごとに元画像ファイルのパスと伸長値をスペース区切りで指定します。伸長値は「相対アスペクト比の対数」で、横方向を正、縦方向を負とします。例えば、横方向に2倍拡大した画像を生成したい場合は、伸長値として `log(2) = 0.6931` を指定します。
具体的には以下のように書きます:
```
images/001.jpg 0.6931
images/002.jpg -0.6931
images/003.jpg 0
```
この場合、001.jpgを横に2倍拡大した画像、002.jpgを縦に2倍拡大した画像、003.jpgそのもの、がそれぞれ課題用画像として生成されます。
3. `images` と `labels.txt` を準備した後、以下のコマンドにより `task.pptx` という名前の課題用pptxファイルが生成されます。
```
python make_pptx.py
```

## 回答ファイルの集計
被験者から回収したpptxファイル達を `answers` ディレクトリに配置します。それから、以下のコマンドを実行すると、誤差の集計結果が出力されます。
```
python measure_answers.py
```
